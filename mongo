#!/bin/sh
#------------------------------------------------------------------------------------------
#----------------------------------------------- MONGO ------------------------------------
#----------------------------------------- Мамедова Фатима --------------------------------

# команда для загрузки файла в MONGO
/usr/bin/mongoimport --host $APP_MONGO_HOST --port $APP_MONGO_PORT --db movies --collection tags --file /data/simple_tags.json

# в файле agg.js три задачи
# - подсчитайте число элементов в созданной коллекции
db.tags.find().count()
# ответ: 158680

# - подсчитайте число фильмов с конкретным тегом - `woman`
db.tags.find({name:'woman'}).count()
# 19 записей, а вообще 1 фильм с id=15184

# - используя группировку данных ($groupby) вывести top-3 самых распространённых тегов
db.tags.aggregate([{$group: {_id: "$name", tag_count: {$sum: 1}}},{$sort:{"tag_count":-1}},{$limit:3}])
# 1й результат: { "_id" : "woman director", "tag_count" : 3115 }
# 2й результат: { "_id" : "independent film", "tag_count" : 1930 }
# 3й результат: { "_id" : "murder", "tag_count" : 1308 }
